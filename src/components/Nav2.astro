---
import { astroI18n, l } from "astro-i18n";
astroI18n.locale;

const birthDate = new Date(2000, 11, 4); 
const today = new Date();
let age = today.getFullYear() - birthDate.getFullYear();
const isBeforeBirthdayThisYear = today.getMonth() < birthDate.getMonth() || 
    (today.getMonth() === birthDate.getMonth() && today.getDate() < birthDate.getDate());
if (isBeforeBirthdayThisYear) {
    age--; 
}


const params: Record<string, string> = {};
for (const [key, value] of Object.entries(Astro.params)) {
  if (value === undefined) continue;
  params[key] = String(value);
}

const currentLocale = astroI18n.locale;

const languageLabels: Record<string, string> = {
  en: "English",
  it: "Italiano",
  de: "Deutsch",
  fr: "FranÃ§ais",
};

const allLanguages = astroI18n.locales.map((locale) => ({
  locale,
  href: l(Astro.url.pathname, params, { targetLocale: locale }),
  label: languageLabels[locale] ?? locale.toUpperCase(),
}));


const currentLanguage = allLanguages.find(
  (lang) => lang.locale === currentLocale
);


const otherLanguages = allLanguages.filter(
  (lang) => lang.locale !== currentLocale
);



---

<div
  class="fixed top-1 left-1/2 -translate-x-1/2 z-50 w-1/2 sm:w-96 text-white leading-tight"
  x-data="{ info: null }"
  @click.outside="info = null"
>

  <div class="bg-black/60 backdrop-blur-xl rounded-md">
    <button
    type="button"
    class="w-full text-center uppercase p-2 cursor-pointer"
    onclick="scrollToTopEased()"
    >
    Matteo Postinghel
    </button>


    
        <div class="grid grid-cols-3 items-center justify-center align-center mt-2 overflow-hidden p-1 gap-1 h-8">
            <a
            href="#"
            @click.prevent="info === 'about' ? info = null : info = 'about'"
            :class="info === 'about' ? 'bg-white text-black': ' text-white hover:bg-white hover:text-black'"
            class="cursor-pointer transition-all duration-300 flex w-full h-full items-center justify-center rounded-sm"
            >
            About
            </a>

            <a
            href="#"
            @click.prevent="info === 'contact' ? info = null : info = 'contact'"
            :class="info === 'contact' ? 'bg-white text-black': ' text-white hover:bg-white hover:text-black'"
            class="cursor-pointer transition-colors duration-300 flex w-full h-full items-center justify-center rounded-sm"
            >
            Contact
            </a>

            <!-- <a
            href="#"
            @click.prevent="info === 'services' ? info = null : info = 'services'"
            :class="info === 'services' ? 'bg-white text-black' : ' text-white hover:bg-white hover:text-black'"
            class="cursor-pointer transition-colors duration-300 flex w-full h-full items-center justify-center rounded-sm"
            >
            Services
            </a> -->

            <a
            href="#"
            @click.prevent="info === 'language' ? info = null : info = 'language'"
            :class="info === 'language' ? 'bg-white text-black' : ' text-white hover:bg-white hover:text-black'"
            class="cursor-pointer transition-colors duration-300 flex w-full h-full items-center justify-center rounded-sm"
            >
            {currentLanguage?.label}
            </a>

    
            <!-- <button
                type="button"
                @click="darkMode = !darkMode"
                class="group flex w-full items-center justify-center h-full bg-black hover:bg-white transition-colors duration-300 rounded-sm"
                aria-pressed="darkMode">
                <span
                    class="size-[14px] rounded-full bg-white transition-colors duration-300 group-hover:bg-black">
                </span>
            </button> -->
        </div>

        
    </div>

    <div class="relative left-0 top-full mt-1 w-full">


        <div
            x-show="info === 'about'"
            x-cloak 
            x-transition:enter="transition ease-in-out duration-300"
            x-transition:enter-start="opacity-0 -translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            class="absolute w-full p-3 bg-black/60 backdrop-blur-xl rounded-md grid grid-rows-2 gap-8"
        >

            <div>
                <p class="">Visual and digital system designer and researcher, intersecting a human centered approach and new technologies from Munich based in Milan.</p>
                <br>
                <p class="">Work spans across identities, interfaces, and communication systems, operating between research, strategy, and design. Projects are shaped through careful analysis and clear structuring, with an emphasis on coherence, precision, and long term cultural relevance.</p>

            </div>
            <div class="grid grid-cols-3">
                <p class="opacity-50 ">Services</p>
                <div class="col-span-2">
                    <p>Brand strategy/positioning</p>
                    <p>Brand visual identity</p>
                    <p>Creative direction</p>
                    <p>Graphic design</p>
                    <p>UI/UX design</p>
                    <p>Front-end development</p>
                    <p>Type design</p>
                    <p>Information design</p>
                    <p>Wayfinding</p>
                    <p>Cartography</p>
                    <p>Motion design</p>
                </div>
            </div>

            <p class=" opacity-50">Full curriculm on request</p>
        </div>


        <div
            x-show="info === 'contact'"
            x-cloak 
            x-transition:enter="transition ease-in-out duration-300"
            x-transition:enter-start="opacity-0 -translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            class="absolute w-full p-3 bg-black/60 backdrop-blur-xl rounded-md grid grid-rows-2 gap-8"
        >
            <div class="flex flex-col ">
                <div>
                    <!-- <p class="opacity-50 ">E-mail</p> -->
                    <!-- <a href="mailto:matteopostinghel@icloud.com" class="hover:opacity-50 transition-opacity ">matteopostinghel@icloud.com</a> -->
                    <a href="mailto:matteopostinghel@icloud.com" class="hover:opacity-50 transition-opacity ">E-mail</a>
                </div>

                <div>
                    <!-- <p class="opacity-50 ">Linked-In</p> -->
                    <!-- <a href="https://www.linkedin.com/in/matteo-postinghel/" class="hover:opacity-50 transition-opacity" target="_blank">Matteo Postinghel</a> -->
                    <a href="https://www.linkedin.com/in/matteo-postinghel/" class="hover:opacity-50 transition-opacity" target="_blank">Linked-In</a>
                </div>

                <div>
                    <!-- <p class="opacity-50 ">Instagram</p> -->
                    <!-- <a href="https://www.instagram.com/matteopostinghel/" class="hover:opacity-50 transition-opacity" target="_blank">matteopostinghel</a> -->
                    <a href="https://www.instagram.com/matteopostinghel/" class="hover:opacity-50 transition-opacity" target="_blank">Instagram</a>
                </div>
            </div>
            
            <div class="grid grid-cols-3">
                <p class="opacity-50 ">Languages</p>
                <div class="col-span-2">
                    <p>Italian <span class="opacity-50">(C2)</span></p>
                    <p>French <span class="opacity-50">(C2)</span></p>
                    <p>German <span class="opacity-50">(C2)</span></p>
                    <p>English <span class="opacity-50">(C2)</span></p>
                    <p>Spanish <span class="opacity-50">(A2)</span></p>
                    <p>Portuguese <span class="opacity-50">(A2)</span></p>
                </div>
            </div>
            
        </div>



        <!-- <div
            x-show="info === 'services'"
            x-cloak 
            x-transition:enter="transition ease-in-out duration-300"
            x-transition:enter-start="opacity-0 -translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            class="absolute w-full p-3 bg-black/60 backdrop-blur-xl rounded-md gap-8"
        >

        </div> -->


        <div
            x-show="info === 'language'"
            x-cloak 
            x-transition:enter="transition ease-in-out duration-300"
            x-transition:enter-start="opacity-0 -translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            class="absolute w-full p-3 bg-black/60 backdrop-blur-xl rounded-md grid grid-cols-3 gap-4"
            >
            <p class="opacity-50">Language</p>
            <div class="col-span-2">
                {otherLanguages.map(({ href, label }) => (
                    <a
                    href={href}
                    @click="info = null"
                    class="flex items-center rounded-sm text-white hover:opacity-50 transition-opacity duration-300"
                    >
                    {label}
                    </a>
                ))}
            </div>

        </div>





    </div>
</div>



<script is:inline>
    function scrollToTopEased(duration = 1000) {
        const start = window.scrollY;
        const startTime = performance.now();

        function easeInOutCubic(t) {
        return t < 0.5
            ? 4 * t * t * t
            : 1 - Math.pow(-2 * t + 2, 3) / 2;
        }

        function animate(time) {
        const elapsed = time - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const eased = easeInOutCubic(progress);

        window.scrollTo(0, start * (1 - eased));

        if (progress < 1) {
            requestAnimationFrame(animate);
        }
        }

        requestAnimationFrame(animate);
    }
</script>